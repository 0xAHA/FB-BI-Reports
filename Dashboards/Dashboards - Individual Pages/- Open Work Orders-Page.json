[ {
  "name" : "- Open Work Orders",
  "description" : "- Open Work Orders",
  "data" : "<!DOCTYPE html>\r\n<html lang=\"en\">\r\n<head>\r\n    <meta charset=\"UTF-8\">\r\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\r\n    <title>Open Work Orders</title>\r\n\r\n    <!-- Google Fonts - Inter -->\r\n    <link href=\"https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap\" rel=\"stylesheet\">\r\n\r\n    <!-- Moment.js for date formatting -->\r\n    <script src=\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.29.4/moment.min.js\"></script>\r\n\r\n    <style>\r\n        * {\r\n            margin: 0;\r\n            padding: 0;\r\n            box-sizing: border-box;\r\n        }\r\n\r\n        body {\r\n            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;\r\n            font-size: 12px;\r\n            padding: 8px;\r\n            background: #f5f5f5;\r\n        }\r\n\r\n        .header {\r\n            display: flex;\r\n            justify-content: space-between;\r\n            align-items: center;\r\n            margin-bottom: 8px;\r\n            padding: 8px;\r\n            background: white;\r\n            border: 1px solid #ddd;\r\n            border-radius: 4px;\r\n        }\r\n\r\n        .header h1 {\r\n            font-size: 16px;\r\n            font-weight: 600;\r\n            color: #333;\r\n        }\r\n\r\n        .controls {\r\n            display: flex;\r\n            gap: 8px;\r\n            align-items: center;\r\n        }\r\n\r\n        .btn {\r\n            padding: 6px 12px;\r\n            font-size: 12px;\r\n            border: 1px solid #ccc;\r\n            background: white;\r\n            border-radius: 3px;\r\n            cursor: pointer;\r\n            font-weight: 500;\r\n        }\r\n\r\n        .btn:hover {\r\n            background: #f0f0f0;\r\n        }\r\n\r\n        .btn-primary {\r\n            background: #2d9cdb;\r\n            color: white;\r\n            border-color: #2d9cdb;\r\n        }\r\n\r\n        .btn-primary:hover {\r\n            background: #1e7bb4;\r\n        }\r\n\r\n        .table-container {\r\n            background: white;\r\n            border: 1px solid #ddd;\r\n            border-radius: 4px;\r\n            overflow: auto;\r\n            height: calc(100vh - 80px);\r\n        }\r\n\r\n        table {\r\n            width: 100%;\r\n            border-collapse: collapse;\r\n            font-size: 12px;\r\n            table-layout: auto;\r\n        }\r\n\r\n        th {\r\n            background: #f8f9fa;\r\n            padding: 12px 8px;\r\n            text-align: left;\r\n            font-size: 12px;\r\n            font-weight: 600;\r\n            color: #475569;\r\n            text-transform: uppercase;\r\n            letter-spacing: 0.5px;\r\n            border-bottom: 2px solid #e2e8f0;\r\n            position: sticky;\r\n            top: 0;\r\n            z-index: 10;\r\n            white-space: nowrap;\r\n            cursor: pointer;\r\n            user-select: none;\r\n        }\r\n\r\n        /* Column width controls */\r\n        th[data-column=\"scheduleindicator\"], td:first-child {\r\n            width: 50px;\r\n            min-width: 50px;\r\n            max-width: 50px;\r\n        }\r\n\r\n        th[data-column=\"statusname\"] {\r\n            width: 100px;\r\n            min-width: 100px;\r\n        }\r\n\r\n        th[data-column=\"monum\"],\r\n        th[data-column=\"num\"],\r\n        th[data-column=\"bomnum\"] {\r\n            width: 100px;\r\n            min-width: 80px;\r\n        }\r\n\r\n        th[data-column=\"qty\"] {\r\n            width: 80px;\r\n            min-width: 60px;\r\n        }\r\n\r\n        th[data-column=\"datescheduledtostart\"],\r\n        th[data-column=\"datescheduled\"],\r\n        th[data-column=\"dateissued\"] {\r\n            width: 110px;\r\n            min-width: 100px;\r\n        }\r\n\r\n        th:hover {\r\n            background: #e9ecef;\r\n        }\r\n\r\n        th[draggable=\"true\"] {\r\n            cursor: move;\r\n        }\r\n\r\n        th.drag-over {\r\n            background: #cbd5e1;\r\n            border-left: 3px solid #2d9cdb;\r\n        }\r\n\r\n        th .sort-icon {\r\n            margin-left: 4px;\r\n            font-size: 10px;\r\n            color: #94a3b8;\r\n        }\r\n\r\n        td {\r\n            padding: 8px;\r\n            border-bottom: 1px solid #e9ecef;\r\n            color: #334155;\r\n            font-size: 12px;\r\n            max-width: 250px;\r\n            overflow: hidden;\r\n            text-overflow: ellipsis;\r\n            white-space: nowrap;\r\n        }\r\n\r\n        tr:hover {\r\n            background-color: #f8fafc;\r\n        }\r\n\r\n        tr:nth-child(even) {\r\n            background-color: #fafafa;\r\n        }\r\n\r\n        tr:nth-child(even):hover {\r\n            background-color: #f8fafc;\r\n        }\r\n\r\n        .filter-row input {\r\n            width: 100%;\r\n            padding: 4px;\r\n            font-size: 11px;\r\n            border: 1px solid #cbd5e1;\r\n            border-radius: 3px;\r\n        }\r\n\r\n        .filter-row input:focus {\r\n            outline: none;\r\n            border-color: #2d9cdb;\r\n        }\r\n\r\n        .wo-link, .mo-link, .bom-link {\r\n            color: #2d9cdb;\r\n            text-decoration: none;\r\n            font-weight: 600;\r\n        }\r\n\r\n        .wo-link:hover, .mo-link:hover, .bom-link:hover {\r\n            text-decoration: underline;\r\n            color: #1e7bb4;\r\n        }\r\n\r\n        .status-badge {\r\n            display: inline-block;\r\n            padding: 2px 8px;\r\n            border-radius: 3px;\r\n            font-size: 11px;\r\n            font-weight: 600;\r\n        }\r\n\r\n        .status-entered {\r\n            background: #fff3cd;\r\n            color: #856404;\r\n        }\r\n\r\n        .status-started {\r\n            background: #cce5ff;\r\n            color: #004085;\r\n        }\r\n\r\n        th.schedule-col {\r\n            width: 40px;\r\n            text-align: center;\r\n            padding-left: 4px;\r\n            padding-right: 4px;\r\n        }\r\n\r\n        .clock-icon {\r\n            width: 16px;\r\n            height: 16px;\r\n            display: inline-block;\r\n            vertical-align: middle;\r\n        }\r\n\r\n        .loading {\r\n            position: fixed;\r\n            top: 0;\r\n            left: 0;\r\n            right: 0;\r\n            bottom: 0;\r\n            background: rgba(0, 0, 0, 0.5);\r\n            display: flex;\r\n            align-items: center;\r\n            justify-content: center;\r\n            z-index: 9999;\r\n        }\r\n\r\n        .loading-content {\r\n            background: white;\r\n            padding: 20px 30px;\r\n            border-radius: 8px;\r\n            text-align: center;\r\n        }\r\n\r\n        .spinner {\r\n            border: 3px solid #f3f3f3;\r\n            border-top: 3px solid #2d9cdb;\r\n            border-radius: 50%;\r\n            width: 40px;\r\n            height: 40px;\r\n            animation: spin 1s linear infinite;\r\n            margin: 0 auto 10px;\r\n        }\r\n\r\n        @keyframes spin {\r\n            0% { transform: rotate(0deg); }\r\n            100% { transform: rotate(360deg); }\r\n        }\r\n\r\n        .filter-info {\r\n            font-size: 12px;\r\n            color: #666;\r\n            padding: 4px 8px;\r\n            background: #fff3cd;\r\n            border-radius: 3px;\r\n        }\r\n\r\n        /* Debug Console */\r\n        #debugConsole {\r\n            margin-top: 12px;\r\n            background: #1e293b;\r\n            border: 1px solid #334155;\r\n            border-radius: 4px;\r\n            padding: 12px;\r\n        }\r\n\r\n        #debugLog {\r\n            background: #0f172a;\r\n            border-radius: 4px;\r\n            padding: 8px;\r\n            height: 200px;\r\n            overflow-y: auto;\r\n            font-family: 'Courier New', monospace;\r\n            font-size: 11px;\r\n            color: #e2e8f0;\r\n        }\r\n    </style>\r\n</head>\r\n<body>\r\n    <div class=\"header\">\r\n        <div>\r\n            <h1>Open Work Orders</h1>\r\n        </div>\r\n        <div class=\"controls\">\r\n            <span id=\"filterInfo\" class=\"filter-info\" style=\"display: none;\"></span>\r\n            <button class=\"btn\" onclick=\"clearFilters()\">Clear Filters</button>\r\n            <button class=\"btn btn-primary\" onclick=\"loadData()\">Refresh</button>\r\n        </div>\r\n    </div>\r\n\r\n    <div class=\"table-container\">\r\n        <table id=\"dataTable\">\r\n            <thead>\r\n                <tr id=\"headerRow\">\r\n                    <th draggable=\"true\" data-column=\"scheduleindicator\" class=\"schedule-col\" onclick=\"sortTable('datescheduled')\" title=\"Schedule Status\">\r\n                        <svg class=\"clock-icon\" viewBox=\"0 0 24 24\" fill=\"currentColor\">\r\n                            <path d=\"M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 10.414V7a1 1 0 10-2 0v6a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L13 12.414z\"/>\r\n                        </svg>\r\n                    </th>\r\n                    <th draggable=\"true\" data-column=\"statusname\" onclick=\"sortTable('statusname')\">Status <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"monum\" onclick=\"sortTable('monum')\">MO # <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"num\" onclick=\"sortTable('num')\">WO # <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"bomnum\" onclick=\"sortTable('bomnum')\">BOM # <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"qty\" onclick=\"sortTable('qty')\">Qty <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"datescheduledtostart\" onclick=\"sortTable('datescheduledtostart')\">Start Date <span class=\"sort-icon\">⇅</span></th>\r\n                    <th draggable=\"true\" data-column=\"datescheduled\" onclick=\"sortTable('datescheduled')\">Scheduled Date <span class=\"sort-icon\">⇅</span></th>\r\n                </tr>\r\n                <tr class=\"filter-row\" id=\"filterRow\">\r\n                    <td data-filter=\"scheduleindicator\"></td>\r\n                    <td><input type=\"text\" data-filter=\"statusname\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"monum\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"num\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"bomnum\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"qty\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"datescheduledtostart\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                    <td><input type=\"text\" data-filter=\"datescheduled\" placeholder=\"Filter...\" onkeyup=\"applyFilters()\"></td>\r\n                </tr>\r\n            </thead>\r\n            <tbody id=\"tableBody\">\r\n                <tr>\r\n                    <td colspan=\"8\" style=\"text-align: center; padding: 20px; color: #94a3b8;\">Loading...</td>\r\n                </tr>\r\n            </tbody>\r\n        </table>\r\n    </div>\r\n\r\n    <!-- Debug Console -->\r\n    <div id=\"debugConsole\" style=\"display: none;\">\r\n        <div style=\"display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;\">\r\n            <h3 style=\"font-size: 12px; font-weight: 600; color: #94a3b8; margin: 0;\">Debug Console</h3>\r\n            <button onclick=\"clearDebugLog()\" class=\"btn\" style=\"padding: 4px 8px; font-size: 11px;\">Clear</button>\r\n        </div>\r\n        <div id=\"debugLog\">\r\n            <div style=\"color: #64748b; font-style: italic;\">Initializing...</div>\r\n        </div>\r\n    </div>\r\n\r\n    <div id=\"loading\" class=\"loading\" style=\"display: none;\">\r\n        <div class=\"loading-content\">\r\n            <div class=\"spinner\"></div>\r\n            <p style=\"font-weight: 600; color: #333;\">Loading work orders...</p>\r\n        </div>\r\n    </div>\r\n\r\n    <script>\r\n        // Get date format from Fishbowl settings (Java SimpleDateFormat)\r\n        const FB_DATE_FORMAT = typeof getProperty === 'function' ? getProperty('DateFormatShort', 'MM/dd/yyyy') : 'MM/dd/yyyy';\r\n        // Convert Java SimpleDateFormat to Moment.js format (dd→DD, yyyy→YYYY)\r\n        const MOMENT_DATE_FORMAT = FB_DATE_FORMAT\r\n            .replace(/yyyy/g, 'YYYY')\r\n            .replace(/yy/g, 'YY')\r\n            .replace(/dd/g, 'DD');\r\n\r\n        // Get BI_SHOW_DEBUG property (default to false if property can't be read)\r\n        const BI_SHOW_DEBUG_PROP = typeof getProperty === 'function' ? getProperty('BI_SHOW_DEBUG', 'false') : 'false';\r\n        const DEBUG_MODE = BI_SHOW_DEBUG_PROP === 'true' || BI_SHOW_DEBUG_PROP === true;\r\n\r\n        let allData = [];\r\n        let filteredData = [];\r\n        let sortColumn = 'datescheduled';\r\n        let sortDirection = 'asc';\r\n        let columnOrder = ['scheduleindicator', 'statusname', 'monum', 'num', 'bomnum', 'qty', 'datescheduledtostart', 'datescheduled'];\r\n\r\n        // Load saved column order\r\n        try {\r\n            var savedOrder = localStorage.getItem('workOrdersColumnOrder');\r\n            if (savedOrder) {\r\n                columnOrder = JSON.parse(savedOrder);\r\n            }\r\n        } catch (e) {\r\n            // Ignore localStorage errors\r\n        }\r\n\r\n        // Debug logging\r\n        function debugLog(message, type) {\r\n            if (!DEBUG_MODE) return;\r\n\r\n            var timestamp = new Date().toLocaleTimeString();\r\n            var logDiv = document.getElementById('debugLog');\r\n\r\n            var placeholder = logDiv.querySelector('[style*=\"italic\"]');\r\n            if (placeholder) {\r\n                logDiv.innerHTML = '';\r\n            }\r\n\r\n            var colors = {\r\n                'info': '#60a5fa',\r\n                'success': '#34d399',\r\n                'warning': '#fbbf24',\r\n                'error': '#f87171',\r\n                'query': '#a78bfa'\r\n            };\r\n\r\n            var entry = document.createElement('div');\r\n            entry.style.marginBottom = '4px';\r\n            entry.innerHTML = '<span style=\"color: #64748b;\">[' + timestamp + ']</span> <span style=\"color: ' + colors[type] + ';\">' + message + '</span>';\r\n\r\n            logDiv.appendChild(entry);\r\n            logDiv.scrollTop = logDiv.scrollHeight;\r\n        }\r\n\r\n        function clearDebugLog() {\r\n            document.getElementById('debugLog').innerHTML = '<div style=\"color: #64748b; font-style: italic;\">Log cleared...</div>';\r\n        }\r\n\r\n        // Format date using Fishbowl DateFormatShort property\r\n        function formatDate(dateStr) {\r\n            if (!dateStr) return '';\r\n            return moment(dateStr).format(MOMENT_DATE_FORMAT);\r\n        }\r\n\r\n        // Get schedule status for indicator\r\n        function getScheduleStatus(dateStr) {\r\n            if (!dateStr) return '';\r\n\r\n            // Parse date from SQL format (YYYY-MM-DD HH:mm:ss)\r\n            var dateParts = dateStr.split(' ')[0].split('-');\r\n            var schedDate = new Date(dateParts[0], dateParts[1] - 1, dateParts[2]);\r\n            schedDate.setHours(0, 0, 0, 0);\r\n\r\n            var today = new Date();\r\n            today.setHours(0, 0, 0, 0);\r\n\r\n            // Check if today\r\n            if (schedDate.getTime() === today.getTime()) {\r\n                return 'orange';\r\n            }\r\n\r\n            // Check if past\r\n            if (schedDate < today) {\r\n                return 'red';\r\n            }\r\n\r\n            // Check if within this calendar week (Sunday to Saturday)\r\n            var todayDay = today.getDay(); // 0 = Sunday, 6 = Saturday\r\n            var weekStart = new Date(today);\r\n            weekStart.setDate(today.getDate() - todayDay);\r\n            var weekEnd = new Date(weekStart);\r\n            weekEnd.setDate(weekStart.getDate() + 6);\r\n\r\n            if (schedDate >= weekStart && schedDate <= weekEnd) {\r\n                return 'blue';\r\n            }\r\n\r\n            return '';\r\n        }\r\n\r\n        // Load data\r\n        function loadData() {\r\n            debugLog('Starting data load...', 'info');\r\n            var loading = document.getElementById('loading');\r\n            loading.style.display = 'flex';\r\n\r\n            try {\r\n                // Get current user\r\n                var currentUser = JSON.parse(getUser());\r\n                var userId = currentUser.id;\r\n                debugLog('Current user ID: ' + userId, 'info');\r\n\r\n                var query =\r\n                    \"SELECT \" +\r\n                    \"    Wo.id AS id, \" +\r\n                    \"    Wo.num AS num, \" +\r\n                    \"    Wo.dateScheduled AS dateScheduled, \" +\r\n                    \"    COALESCE(Wo.dateScheduledToStart, Wo.dateStarted) AS dateScheduledToStart, \" +\r\n                    \"    WoStatus.Name AS statusName, \" +\r\n                    \"    Mo.num AS moNum, \" +\r\n                    \"    Bom.num AS bomNum, \" +\r\n                    \"    MoItem.qtyToFulfill AS qty \" +\r\n                    \"FROM Wo \" +\r\n                    \"LEFT JOIN WoStatus ON Wo.statusId = WoStatus.Id \" +\r\n                    \"LEFT JOIN MoItem ON Wo.moItemId = MoItem.id \" +\r\n                    \"LEFT JOIN Mo ON MoItem.moId = Mo.id \" +\r\n                    \"LEFT JOIN Bom ON MoItem.bomId = Bom.id \" +\r\n                    \"INNER JOIN UserToLG ON Wo.locationGroupId = UserToLG.LocationGroupId AND UserToLG.UserId = \" + userId + \" \" +\r\n                    \"WHERE Wo.statusId IN (10, 30) \" +\r\n                    \"ORDER BY dateScheduled ASC\";\r\n                    \"ORDER BY dateScheduled ASC\";\r\n\r\n                debugLog('Executing SQL query...', 'query');\r\n\r\n                var queryResult = runQuery(query);\r\n                debugLog('Query executed, result type: ' + typeof queryResult, 'info');\r\n\r\n                if (!queryResult) {\r\n                    debugLog('ERROR: Query returned null/undefined', 'error');\r\n                    throw new Error('Query returned no data');\r\n                }\r\n\r\n                debugLog('Query result length: ' + queryResult.length, 'info');\r\n                debugLog('Parsing result...', 'info');\r\n\r\n                var result = JSON.parse(queryResult);\r\n                debugLog('Parsed ' + result.length + ' records', 'success');\r\n\r\n                allData = result;\r\n                applyFilters();\r\n\r\n                debugLog('Load complete: ' + filteredData.length + ' work orders displayed', 'success');\r\n\r\n            } catch (error) {\r\n                debugLog('ERROR: ' + error.message, 'error');\r\n                alert('Error loading work orders: ' + error.message);\r\n            } finally {\r\n                loading.style.display = 'none';\r\n            }\r\n        }\r\n\r\n        // Apply filters\r\n        function applyFilters() {\r\n            filteredData = allData.filter(function(row) {\r\n                // Column filters - use data-filter attributes\r\n                var filterInputs = document.querySelectorAll('.filter-row input[data-filter]');\r\n                for (var i = 0; i < filterInputs.length; i++) {\r\n                    var input = filterInputs[i];\r\n                    if (input.value) {\r\n                        var filterKey = input.getAttribute('data-filter');\r\n                        var cellValue;\r\n\r\n                        // For date columns, filter on formatted date\r\n                        if (filterKey === 'datescheduled' || filterKey === 'datescheduledtostart') {\r\n                            cellValue = formatDate(row[filterKey]).toLowerCase();\r\n                        } else {\r\n                            cellValue = (row[filterKey] || '').toString().toLowerCase();\r\n                        }\r\n\r\n                        var filterValue = input.value.toLowerCase();\r\n                        if (cellValue.indexOf(filterValue) === -1) {\r\n                            return false;\r\n                        }\r\n                    }\r\n                }\r\n\r\n                return true;\r\n            });\r\n\r\n            updateFilterInfo();\r\n            sortAndRender();\r\n        }\r\n\r\n        // Update filter info\r\n        function updateFilterInfo() {\r\n            var filterInfo = document.getElementById('filterInfo');\r\n            if (allData.length !== filteredData.length) {\r\n                filterInfo.textContent = 'Showing ' + filteredData.length + ' of ' + allData.length + ' work orders';\r\n                filterInfo.style.display = 'inline-block';\r\n            } else {\r\n                filterInfo.style.display = 'none';\r\n            }\r\n        }\r\n\r\n        // Clear filters\r\n        function clearFilters() {\r\n            var inputs = document.querySelectorAll('.filter-row input');\r\n            for (var i = 0; i < inputs.length; i++) {\r\n                inputs[i].value = '';\r\n            }\r\n            applyFilters();\r\n        }\r\n\r\n        // Sort table\r\n        function sortTable(column) {\r\n            if (sortColumn === column) {\r\n                sortDirection = sortDirection === 'asc' ? 'desc' : 'asc';\r\n            } else {\r\n                sortColumn = column;\r\n                sortDirection = 'asc';\r\n            }\r\n\r\n            sortAndRender();\r\n        }\r\n\r\n        // Sort and render\r\n        function sortAndRender() {\r\n            filteredData.sort(function(a, b) {\r\n                var aVal = a[sortColumn] || '';\r\n                var bVal = b[sortColumn] || '';\r\n\r\n                if (aVal < bVal) return sortDirection === 'asc' ? -1 : 1;\r\n                if (aVal > bVal) return sortDirection === 'asc' ? 1 : -1;\r\n                return 0;\r\n            });\r\n\r\n            renderTable();\r\n        }\r\n\r\n        // Create cell content for a given column\r\n        function createCellContent(row, column) {\r\n            var td = document.createElement('td');\r\n\r\n            if (column === 'scheduleindicator') {\r\n                var scheduleStatus = getScheduleStatus(row.datescheduled);\r\n                if (scheduleStatus) {\r\n                    var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\r\n                    svg.setAttribute('class', 'clock-icon');\r\n                    svg.setAttribute('viewBox', '0 0 24 24');\r\n                    svg.setAttribute('fill', 'currentColor');\r\n                    svg.style.width = '20px';\r\n                    svg.style.height = '20px';\r\n                    if (scheduleStatus === 'blue') svg.style.color = '#2d9cdb';\r\n                    else if (scheduleStatus === 'orange') svg.style.color = '#f59e0b';\r\n                    else if (scheduleStatus === 'red') svg.style.color = '#ef4444';\r\n\r\n                    var path = document.createElementNS('http://www.w3.org/2000/svg', 'path');\r\n                    path.setAttribute('d', 'M12 2C6.477 2 2 6.477 2 12s4.477 10 10 10 10-4.477 10-10S17.523 2 12 2zm1 10.414V7a1 1 0 10-2 0v6a1 1 0 00.293.707l3 3a1 1 0 001.414-1.414L13 12.414z');\r\n                    path.setAttribute('fill', 'none');\r\n                    path.setAttribute('stroke', 'currentColor');\r\n                    path.setAttribute('stroke-width', '1.8');\r\n                    path.setAttribute('stroke-linecap', 'round');\r\n                    path.setAttribute('stroke-linejoin', 'round');\r\n                    svg.appendChild(path);\r\n                    td.appendChild(svg);\r\n                    td.style.textAlign = 'center';\r\n\r\n                    // Add tooltip\r\n                    if (scheduleStatus === 'orange') {\r\n                        td.title = 'Scheduled for today';\r\n                    } else if (scheduleStatus === 'red') {\r\n                        td.title = 'Past due';\r\n                    } else if (scheduleStatus === 'blue') {\r\n                        td.title = 'Scheduled this week';\r\n                    }\r\n                }\r\n            } else if (column === 'statusname') {\r\n                var statusClass = 'status-badge';\r\n                if (row.statusname === 'Entered') statusClass += ' status-entered';\r\n                else if (row.statusname === 'Started') statusClass += ' status-started';\r\n                var badge = document.createElement('span');\r\n                badge.className = statusClass;\r\n                badge.textContent = row.statusname || '';\r\n                td.appendChild(badge);\r\n                td.title = row.statusname || '';\r\n            } else if (column === 'monum') {\r\n                if (row.monum) {\r\n                    var moLink = document.createElement('a');\r\n                    moLink.href = '#';\r\n                    moLink.className = 'mo-link';\r\n                    moLink.textContent = row.monum;\r\n                    moLink.onclick = function(num) {\r\n                        return function(e) {\r\n                            e.preventDefault();\r\n                            openMO(num);\r\n                            return false;\r\n                        };\r\n                    }(row.monum);\r\n                    td.appendChild(moLink);\r\n                    td.title = row.monum;\r\n                } else {\r\n                    td.textContent = '';\r\n                }\r\n            } else if (column === 'num') {\r\n                var woLink = document.createElement('a');\r\n                woLink.href = '#';\r\n                woLink.className = 'wo-link';\r\n                woLink.textContent = row.num;\r\n                woLink.onclick = function(num) {\r\n                    return function(e) {\r\n                        e.preventDefault();\r\n                        openWO(num);\r\n                        return false;\r\n                    };\r\n                }(row.num);\r\n                td.appendChild(woLink);\r\n                td.title = row.num;\r\n            } else if (column === 'bomnum') {\r\n                if (row.bomnum) {\r\n                    var bomLink = document.createElement('a');\r\n                    bomLink.href = '#';\r\n                    bomLink.className = 'bom-link';\r\n                    bomLink.textContent = row.bomnum;\r\n                    bomLink.onclick = function(num) {\r\n                        return function(e) {\r\n                            e.preventDefault();\r\n                            openBOM(num);\r\n                            return false;\r\n                        };\r\n                    }(row.bomnum);\r\n                    td.appendChild(bomLink);\r\n                    td.title = row.bomnum;\r\n                } else {\r\n                    td.textContent = '';\r\n                }\r\n            } else if (column === 'qty') {\r\n                td.textContent = row.qty || '';\r\n                td.title = row.qty || '';\r\n            } else if (column === 'datescheduledtostart') {\r\n                td.textContent = formatDate(row.datescheduledtostart);\r\n                td.title = formatDate(row.datescheduledtostart);\r\n            } else if (column === 'datescheduled') {\r\n                td.textContent = formatDate(row.datescheduled);\r\n                td.title = formatDate(row.datescheduled);\r\n            }\r\n\r\n            return td;\r\n        }\r\n\r\n        // Render table\r\n        function renderTable() {\r\n            var tbody = document.getElementById('tableBody');\r\n            tbody.innerHTML = '';\r\n\r\n            if (filteredData.length === 0) {\r\n                tbody.innerHTML = '<tr><td colspan=\"8\" style=\"text-align: center; padding: 20px; color: #94a3b8;\">No work orders found</td></tr>';\r\n                return;\r\n            }\r\n\r\n            for (var i = 0; i < filteredData.length; i++) {\r\n                var row = filteredData[i];\r\n                var tr = document.createElement('tr');\r\n\r\n                // Create cells in column order\r\n                for (var j = 0; j < columnOrder.length; j++) {\r\n                    var cell = createCellContent(row, columnOrder[j]);\r\n                    tr.appendChild(cell);\r\n                }\r\n\r\n                tbody.appendChild(tr);\r\n            }\r\n\r\n            debugLog('Rendered ' + filteredData.length + ' rows', 'success');\r\n        }\r\n\r\n        // Open Work Order\r\n        function openWO(woNum) {\r\n            openModule(\"Work Order\", woNum);\r\n        }\r\n\r\n        // Open Manufacture Order\r\n        function openMO(moNum) {\r\n            openModule(\"Manufacture Order\", moNum);\r\n        }\r\n\r\n        // Open BOM\r\n        function openBOM(bomNum) {\r\n            openModule(\"Bill of Materials\", bomNum);\r\n        }\r\n\r\n        // Drag and drop for column reordering\r\n        var draggedColumn = null;\r\n\r\n        function handleDragStart(e) {\r\n            draggedColumn = this;\r\n            e.dataTransfer.effectAllowed = 'move';\r\n            e.dataTransfer.setData('text/html', this.innerHTML);\r\n            this.style.opacity = '0.4';\r\n        }\r\n\r\n        function handleDragOver(e) {\r\n            if (e.preventDefault) {\r\n                e.preventDefault();\r\n            }\r\n            e.dataTransfer.dropEffect = 'move';\r\n            return false;\r\n        }\r\n\r\n        function handleDragEnter(e) {\r\n            this.classList.add('drag-over');\r\n        }\r\n\r\n        function handleDragLeave(e) {\r\n            this.classList.remove('drag-over');\r\n        }\r\n\r\n        function handleDrop(e) {\r\n            if (e.stopPropagation) {\r\n                e.stopPropagation();\r\n            }\r\n\r\n            if (draggedColumn !== this) {\r\n                var fromIndex = Array.from(this.parentNode.children).indexOf(draggedColumn);\r\n                var toIndex = Array.from(this.parentNode.children).indexOf(this);\r\n\r\n                // Reorder columnOrder array\r\n                var temp = columnOrder[fromIndex];\r\n                columnOrder.splice(fromIndex, 1);\r\n                columnOrder.splice(toIndex, 0, temp);\r\n\r\n                // Save to localStorage\r\n                try {\r\n                    localStorage.setItem('workOrdersColumnOrder', JSON.stringify(columnOrder));\r\n                } catch (e) {\r\n                    // Ignore localStorage errors\r\n                }\r\n\r\n                // Reorder headers and filters\r\n                reorderColumns();\r\n                // Re-render table\r\n                renderTable();\r\n            }\r\n\r\n            return false;\r\n        }\r\n\r\n        function handleDragEnd(e) {\r\n            this.style.opacity = '1';\r\n            var headers = document.querySelectorAll('#headerRow th');\r\n            for (var i = 0; i < headers.length; i++) {\r\n                headers[i].classList.remove('drag-over');\r\n            }\r\n        }\r\n\r\n        function setupDragAndDrop() {\r\n            var headers = document.querySelectorAll('#headerRow th[draggable=\"true\"]');\r\n            for (var i = 0; i < headers.length; i++) {\r\n                headers[i].addEventListener('dragstart', handleDragStart, false);\r\n                headers[i].addEventListener('dragenter', handleDragEnter, false);\r\n                headers[i].addEventListener('dragover', handleDragOver, false);\r\n                headers[i].addEventListener('dragleave', handleDragLeave, false);\r\n                headers[i].addEventListener('drop', handleDrop, false);\r\n                headers[i].addEventListener('dragend', handleDragEnd, false);\r\n            }\r\n        }\r\n\r\n        function reorderColumns() {\r\n            var headerRow = document.getElementById('headerRow');\r\n            var filterRow = document.getElementById('filterRow');\r\n\r\n            // Reorder header cells\r\n            for (var i = 0; i < columnOrder.length; i++) {\r\n                var col = columnOrder[i];\r\n                var th = headerRow.querySelector('[data-column=\"' + col + '\"]');\r\n                headerRow.appendChild(th);\r\n            }\r\n\r\n            // Reorder filter cells\r\n            for (var i = 0; i < columnOrder.length; i++) {\r\n                var col = columnOrder[i];\r\n                var element = filterRow.querySelector('[data-filter=\"' + col + '\"]');\r\n                var td = element.tagName === 'TD' ? element : element.parentNode;\r\n                filterRow.appendChild(td);\r\n            }\r\n        }\r\n\r\n        // Initialize\r\n        window.onload = function() {\r\n            // Apply saved column order\r\n            reorderColumns();\r\n\r\n            // Setup drag and drop for column reordering\r\n            setupDragAndDrop();\r\n\r\n            if (DEBUG_MODE) {\r\n                document.getElementById('debugConsole').style.display = 'block';\r\n                debugLog('Debug mode enabled', 'info');\r\n                debugLog('BI_SHOW_DEBUG property: ' + BI_SHOW_DEBUG_PROP, 'info');\r\n                debugLog('Date format: ' + FB_DATE_FORMAT, 'info');\r\n            }\r\n\r\n            loadData();\r\n        };\r\n    </script>\r\n</body>\r\n</html>\r\n",
  "active" : true,
  "note" : "",
  "type" : "Page"
} ]